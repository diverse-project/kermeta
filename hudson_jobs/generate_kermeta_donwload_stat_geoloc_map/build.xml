<project name="build_eclipse_bases_for_kermeta" default="all">

	<property name="env.WORKSPACE" location="."/>
	<property name="simple.maven.osgi.file.deploy.url" value="http://tipimouss.irisa.fr/maven2-snapshots/org/kermeta/tools/tools.simple.maven.osgi.file.deploy/1.0.0-SNAPSHOT/tools.simple.maven.osgi.file.deploy-1.0.0-SNAPSHOT.jar"/>
	<property name="data.folder" location="${env.WORKSPACE}/data"/>
	
	
	<target name="all" depends="">
	    <antcall target="get_stat_raw_data"/>
	    <antcall target="generate_map"/>
	</target>	
	<target name="get_stat_raw_data">
		<echo>Step 1 - Retrieve latest version of the raw stat data</echo>
		<!-- <delete>
			<fileset dir="${data.folder}" includes="*"/>
		</delete> -->
		<!-- <mkdir dir="${data.folder}"/>-->
		<exec executable="wget" failonerror="true">
			<arg value="-nv"/>
			<arg value="-r"/>
			<arg value="-l"/>
			<arg value="2"/>
			<arg value="http://www.kermeta.org//awstats_data/kermeta_update/"/>
		</exec>
	</target>
	<target name="generate_map">
		<echo>Step 2 - Preparation the map</echo>
		<exec executable="mvn" failonerror="true">
			<arg value="exec:java" />
			<arg value="-Dexec.mainClass='fr.inria.ipstat.geoloc.mapper.MapperCLI'"/>
		</exec>
		
	</target>
	
</project>
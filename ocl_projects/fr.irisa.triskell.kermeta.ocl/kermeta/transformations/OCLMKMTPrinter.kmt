/* $Id: OCLMKMTPrinter.kmt,v 1.8 2007-05-25 18:11:25 bitterjug Exp $
 * File : Visitors.kmt
 * License : EPL
 * Copyright : IRISA / INRIA / Universite de Rennes 1
 * ----------------------------------------------------------------------------
 * Authors :  Olivier Brais, Mark Skipper
 * 
 */
 
/* This package contains operations code for Visitor Patterns
 You should use Patterns4Ecore.kmt operations for applying Patterns */
package OCLKMTPrinter;

require kermeta
//require "../ecore.kmt"
require "../helpers/OCLHelper.kmt" 
require "../../mmodel/oclcstvisitor.kmt"
require "ocl2kmtVisitor.kmt"  
//require "Tools.kmt"  

using kermeta::standard
using kermeta::persistence
using ocl::cst
using ocl2kmt

class OCLKMTPrinter
{ 
	attribute repository: EMFRepository
	attribute modelURI: String
    reference helper : OCLHelpers::OCLHelper
    reference mhelper : EcoreHelpers::EcoreHelper
    attribute visitor :Ocl2kmtVisitor 
    attribute model : Set<Object> 
    
    operation main(): Void is
		do
			modelURI := "../../model/19.xmi"		
			
			repository := EMFRepository.new
			helper := OCLHelpers::OCLHelper.new
	     	model  := helper.loadOCLModel(repository, modelURI)
	     	
	     	stdio.writeln("model loaded")

	     	visitor := Ocl2kmtVisitor.new	     	
	     	visitor.setMetamodelURI("../../ocl/sample.ecore") 
	     	
	     	stdio.writeln("visitor initialized")
	     	
			helper.getPackageDeclaration(model).accept(visitor)
	    end

}
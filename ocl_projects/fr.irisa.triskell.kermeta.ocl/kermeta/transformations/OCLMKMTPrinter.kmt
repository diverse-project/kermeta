/* $Id: OCLMKMTPrinter.kmt,v 1.10 2007-05-28 13:04:24 barais Exp $
 * File : Visitors.kmt
 * License : EPL
 * Copyright : IRISA / INRIA / Universite de Rennes 1
 * ----------------------------------------------------------------------------
 * Authors :  Olivier Brais, Mark Skipper
 * 
 */
 
/* This package contains operations code for Visitor Patterns
 You should use Patterns4Ecore.kmt operations for applying Patterns */
package OCLKMTPrinter;

require kermeta
//require "../ecore.kmt"
require "../helpers/OCLHelper.kmt"
require "../../mmodel/oclcstvisitor.kmt"
require "ocl2kmtVisitor.kmt"
//require "Tools.kmt"  
require "platform:/resource/fr.irisa.triskell.kermeta.ecore/src/kermeta/helpers/EcoreHelper.kmt"


using kermeta::standard
using kermeta::persistence
using ocl::cst
using ocl2kmt

class OCLKMTPrinter 
{ 
	attribute repository: EMFRepository
	attribute modelURI: String
    reference helper : OCLHelpers::OCLHelper
    reference mhelper : EcoreHelpers::EcoreHelper
    attribute visitor :Ocl2kmtVisitor 
    attribute model : Set<Object> 
    
    operation main(): Void is
		do
			//modelURI := "../../model/17.xmi"		
			//modelURI := "../../model/67.xmi"		
			modelURI := "../../model/69.xmi"		
			 
			repository := EMFRepository.new
			helper := OCLHelpers::OCLHelper.new
	    	//helper.__ecoreOCLMetamodel :="../../ocl/sample.ecore"
	     	visitor := Ocl2kmtVisitor.new
	     	visitor.initialize
	     	model  := helper.loadOCLModel(repository, modelURI)
	     	stdio.writeln("model loaded")
//	     	mhelper  := EcoreHelpers::EcoreHelper.new
//	     	mhelper.ecoreMetamodel :="../../ocl/sample.ecore"
//	     	mhelper
	     	//helper.loadMetaModel()
	     	visitor.setMetamodelURI("../../ocl/sample.ecore") 
	     	stdio.writeln("metamodel loaded")
			helper.getPackageDeclaration(model).accept(visitor)
	    end

}
/* $Id: QualifiedName.kmt,v 1.1 2007-08-13 17:32:24 bitterjug Exp $
 * Creation date: August 13, 2007
 * License:
 * Copyright:
 * Authors:
 */
@mainClass "qualifiedNames::QualifiedName"
@mainOperation "main"
package qualifiedNames;
require kermeta
using kermeta::standard

class QualifiedName inherits Sequence<String>
{
	attribute __separator: String
	
	operation separator(): String is
		do
			if __separator == void then
				result := "::" // default separator
			else
				result := __separator
			end
		end
	
	operation setSeparator(sep: String): QualifiedName is
		do
			self.__separator := sep
		end
		
	method toString():String is
		do
			var it : Iterator<String> init self.iterator
			from
        		result := it.next
    		until
    			it.isOff
    		loop
    			result := result + separator + it.next
    		end
		end
		
	operation appendString(names: String): QualifiedName is
		do
    		result := QualifiedName.new
    		self.each{ n | result.add(n) }
    		var pos : Integer
    		from pos:= names.indexOf(separator)
    		until (pos==-1)
    		loop
    			var name : String init names.substring(0,pos)
    			result.add(name)
    			names := names.substring(pos + separator.size, names.size)
    			pos := names.indexOf(separator)
    		end
    		result.add(names)
		end
		
	operation prependString(names: String): QualifiedName is
		do
    		result := QualifiedName.new
    		var pos : Integer
    		from pos:= names.indexOf(separator)
    		until (pos==-1)
    		loop
    			var name : String init names.substring(0,pos)
    			result.add(name)
    			names := names.substring(pos + separator.size, names.size)
    			pos := names.indexOf(separator)
    		end
    		result.add(names)
    		self.each{ n | result.add(n) }
		end
		
	operation typeName(): String is
		do
			result := self.last
		end
		
	operation packageName(): QualifiedName is
		do
			result := QualifiedName.new
			result.addAll(self)
			result.remove(result.last)
		end
		
	operation main(): Void is
		do
			var qn : QualifiedName init QualifiedName.new.appendString("This::that::theother")
			stdio.writeln(qn.toString)
			stdio.writeln( qn.prependString("here::and::now").toString)
		end
}
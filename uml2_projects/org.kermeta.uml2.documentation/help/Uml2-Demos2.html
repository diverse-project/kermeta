<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>UML transformations</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.2  (Linux)">
	<META NAME="CREATED" CONTENT="20080225;17421200">
	<META NAME="CHANGEDBY" CONTENT="Vincent Mahe">
	<META NAME="CHANGED" CONTENT="20080225;17421200">
</HEAD>
<BODY LANG="fr-FR" BGCOLOR="#ffffff" DIR="LTR">
<H1 LANG="en-US" ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Bitstream Vera Sans"><FONT SIZE=4>UML
transformations</FONT></FONT></FONT></H1>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
O.M.G. “Model Driven Architecture” is based upon a major
distinction between the analysis and design levels in software
conception. The analysis work is supposed to produce platform
independent models (P.I.M.) and the design level generates (in an
automated way if possible) more detailed models which include the
specificities of the platform (hardware and operating system) they
target. There is only one PIM, which embeds all the domain needed
particularities. It can be derived in many PSM, one for each targeted
system.</FONT></FONT></P>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
given transformations are useful for designers who need to automatize
the path from a PIM analysis model to a PSM design model.</FONT></FONT></P>
<H2 LANG="en-US" ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Bitstream Vera Sans"><FONT SIZE=4>A
simple example</FONT></FONT></FONT></H2>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>Take
a simple model describing cars structure. This model is too simple so
it needs to be enhanced.</FONT></FONT></P>
<P LANG="en-US" ALIGN=JUSTIFY><IMG SRC="../img/Vehicules_original_model.jpg" NAME="graphics4" ALIGN=LEFT WIDTH=672 HEIGHT=336 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>We
can write a Kermeta program which will transform this model.</FONT></FONT></P>
<H2 LANG="en-US" ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Bitstream Vera Sans"><FONT SIZE=4>A
simple transformer</FONT></FONT></FONT></H2>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>This
transformer needs access to the <STRONG><FONT COLOR="#000000"><FONT FACE="Bitstream Vera Serif">Uml2
MDK</FONT></FONT></STRONG> tools then it must load the original
model.</FONT></FONT></P>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>As
this model must stay inviolate, the first task is the cloning of this
model into a equivalent one which will be the final result.</FONT></FONT></P>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
“vehicules” model needs an engine interface the two engine
classes will inherit from, an accessor on the “wattsPower”
attribute, a composition link between the “Car” and the
“GasEngine” classes.</FONT></FONT></P>
<DL>
	<DL>
		<DD><P><FONT COLOR="#000000"><FONT FACE="Arial"><FONT SIZE=2><B>When
		new added elements must be named, the tool has naming methods which
		can be overwritten in order to specialize this naming. To do such a
		modification, create your own tool by inheritance of the generic
		one and rewrite the good operations (look at
		<FONT FACE="Monospace"><FONT SIZE=2>SpecializedEngineInterface_Tool</FONT></FONT>
		Class in the example).</B></FONT></FONT></FONT></P>
	</DL>
</DL>
<PRE LANG="zxx"><FONT FACE="Courier New"><FONT SIZE=2><FONT COLOR="#3f5fbe"><B>@</B></FONT><FONT COLOR="#960000"><B>mainClass</B></FONT><FONT COLOR="#3f5fbe"><B> &quot;vehicules::Main&quot;</B></FONT></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#3f5fbe">@</FONT><FONT COLOR="#960000"><B>mainOperation</B></FONT><FONT COLOR="#3f5fbe"> &quot;main&quot;</FONT></SPAN></FONT></FONT>

<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000064"><B>package</B></FONT><FONT COLOR="#000000"> vehicules;</FONT></SPAN></FONT></FONT>

<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#960000"><B>require</B></FONT><FONT COLOR="#000000"> kermeta</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#960000"><B>require</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbe">&quot;platform:/plugin/org.kermeta.uml2/src/kermeta/transformations/StaticTools.kmt&quot;</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#960000"><B>require</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbe">&quot;platform:/plugin/org.kermeta.uml2/src/kermeta/transformations/UmlCloneFactory.kmt&quot;</FONT></SPAN></FONT></FONT>

<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000064"><B>class</B></FONT><FONT COLOR="#000000"> Main</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">{</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>reference</B></FONT><FONT COLOR="#000000"> origModelName : kermeta::standard::String</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>reference</B></FONT><FONT COLOR="#000000"> origModel : uml::Model</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>reference</B></FONT><FONT COLOR="#000000"> cloneModelName : kermeta::standard::String</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>reference</B></FONT><FONT COLOR="#000000"> cloneModel : uml::Model</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>reference</B></FONT><FONT COLOR="#000000"> root_package : uml::Package</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbe">/**</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 * This sample program will preserve the given sample model</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 * in order to be reused as many times as you want.</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 * So the program loads the model, clones it,</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 * and then does the transformations on the clone.</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 * You can then open the resulting model in the Ecore editor</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 * or use a graphical editor (like TopCased) to draw it.</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 */</SPAN></FONT></FONT>
<FONT COLOR="#000000">    </FONT><FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000064"><B>operation</B></FONT><FONT COLOR="#000000"> main() : </FONT><FONT COLOR="#000000"><B>Void</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>is</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>do</B></FONT></SPAN></FONT></FONT>
    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	 </SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		stdio.writeln(</FONT><FONT COLOR="#3f5fbe">&quot; &gt;&gt;&gt;------&gt; loading the original model&quot;</FONT><FONT COLOR="#000000">)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">//creating needed instances</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		origModelName := </FONT><FONT COLOR="#3f5fbe">&quot;platform:/resource/org.kermeta.uml2.samples/vehicules/models/vehicules.uml&quot;</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</FONT><FONT COLOR="#41825a">// load the given UML2 resource</FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> inputRepository : kermeta::persistence::EMFRepository </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> kermeta::persistence::EMFRepository.new</FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> inputResource : kermeta::persistence::EMFResource</FONT></SPAN></FONT></FONT>
    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	inputResource ?= inputRepository.getResource(origModelName)</SPAN></FONT></FONT>
    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</FONT><FONT COLOR="#41825a">// &quot;instances&quot; only gives the main diagramm package for the targeted code tree</FONT></SPAN></FONT></FONT>
    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	origModel ?= inputResource.instances.one</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		stdio.writeln(</FONT><FONT COLOR="#3f5fbe">&quot; &gt;&gt;&gt;------&gt; cloning the original model (kept virgin) into a new one&quot;</FONT><FONT COLOR="#000000">)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> factory : uml::transformations::UmlCloneFactory </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> uml::transformations::UmlCloneFactory.new</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		factory.initialize</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		cloneModel := factory.cloneStaticDiagram(origModel)</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		stdio.writeln(</FONT><FONT COLOR="#3f5fbe">&quot; &gt;&gt;&gt;------&gt; transforming the cloned model&quot;</FONT><FONT COLOR="#000000">)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we need the package containing the classes</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		root_package ?= cloneModel.packagedElement.select{ e | e.name == </FONT><FONT COLOR="#3f5fbe">&quot;vehicules&quot;</FONT><FONT COLOR="#000000"> }.one</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		addGetterOnWattsPower</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		addEngineInterface</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		addCarEngineComposition</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		addEngineGeneralisation</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		stdio.writeln(</FONT><FONT COLOR="#3f5fbe">&quot; &gt;&gt;&gt;------&gt; saving the transformed model&quot;</FONT><FONT COLOR="#000000">)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		cloneModelName := </FONT><FONT COLOR="#3f5fbe">&quot;platform:/resource/org.kermeta.uml2.samples/vehicules/models/improved_vehicules.uml&quot;</FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> outputRepository : kermeta::persistence::EMFRepository </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> kermeta::persistence::EMFRepository.new</FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> outputResource : kermeta::persistence::EMFResource</FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	outputResource ?= outputRepository.createResource(cloneModelName, </FONT><FONT COLOR="#3f5fbe">&quot;platform:/plugin/org.eclipse.uml2.uml/model/UML.ecore&quot;</FONT><FONT COLOR="#000000">)</FONT></SPAN></FONT></FONT>
    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	outputResource.instances.add(cloneModel)</SPAN></FONT></FONT>
    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	outputResource.save()</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		stdio.writeln(</FONT><FONT COLOR="#3f5fbe">&quot; &lt;------&lt;&lt;&lt; model saved&quot;</FONT><FONT COLOR="#000000">)</FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    </FONT><FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
    
<FONT COLOR="#000000">    </FONT><FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#41825a">/////////////  code for transformations //////////////////</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>operation</B></FONT><FONT COLOR="#000000"> addGetterOnWattsPower() </FONT><FONT COLOR="#000064"><B>is</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>do</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we get the &quot;GasEngine&quot; class (before this class will loose its attributes, passed to the interface)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> cl : uml::Class</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		cl ?= root_package.packagedElement.select{ e | e.name == </FONT><FONT COLOR="#3f5fbe">&quot;GasEngine&quot;</FONT><FONT COLOR="#000000"> }.one</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we need the accessors tool for transformation</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> accTool : uml::transformations::Accessor_Tool </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> uml::transformations::Accessor_Tool.new</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we make the getter corresponding to each property of the class</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		cl.ownedAttribute.each{ prop |</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">			</FONT><FONT COLOR="#41825a">// we add the getter operation corresponding to the property</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">			accTool.addGetter(cl, prop)</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		}</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>operation</B></FONT><FONT COLOR="#000000"> addEngineInterface() </FONT><FONT COLOR="#000064"><B>is</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>do</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we get the &quot;GasEngine&quot; class to generalize it in a &quot;IEngine&quot; interface</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> cl : uml::Class</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		cl ?= root_package.packagedElement.select{ e | e.name == </FONT><FONT COLOR="#3f5fbe">&quot;GasEngine&quot;</FONT><FONT COLOR="#000000"> }.one</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we need the interface tool for extraction</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> ifTool : SpecializedEngineInterface_Tool </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> SpecializedEngineInterface_Tool.new</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we get then the interface</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> ifc : uml::Interface</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		ifc := ifTool.extractInterface(cl)</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we add the new interface to the resulting model</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		root_package.packagedElement.add(ifc)</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// Rem: the interfaceRealization between the interface and the (original)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// concrete class doesn't need to be added to the model</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// (it is owned by the concrete class)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>operation</B></FONT><FONT COLOR="#000000"> addCarEngineComposition() </FONT><FONT COLOR="#000064"><B>is</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>do</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we get the &quot;IEngine&quot; interface to link it with &quot;Car&quot; class</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> iEngine : uml::Interface</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		iEngine ?= root_package.packagedElement.select{ e | e.name == </FONT><FONT COLOR="#3f5fbe">&quot;IEngine&quot;</FONT><FONT COLOR="#000000"> }.one</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we get the &quot;Car&quot; class to associate it with an &quot;IEngine&quot; interface</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> clCar : uml::Class</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		clCar ?= root_package.packagedElement.select{ e | e.name == </FONT><FONT COLOR="#3f5fbe">&quot;Car&quot;</FONT><FONT COLOR="#000000"> }.one</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we need the association tool for transformation</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> assocTool : uml::transformations::Association_Tool </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> uml::transformations::Association_Tool.new</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we then get the new composition</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> assoc : uml::Association </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> uml::Association.new</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		assoc := assocTool.addNavigableComposition(clCar, iEngine, </FONT><FONT COLOR="#3f5fbe">&quot;poweredBy&quot;</FONT><FONT COLOR="#000000">, </FONT><FONT COLOR="#3f5fbe">&quot;engine&quot;</FONT><FONT COLOR="#000000">)</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we add the new association to the resulting model</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		root_package.packagedElement.add(assoc)</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>operation</B></FONT><FONT COLOR="#000000"> addEngineGeneralisation() </FONT><FONT COLOR="#000064"><B>is</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>do</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we need the interface tool to link interface and engine</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> ifTool : SpecializedEngineInterface_Tool </FONT><FONT COLOR="#000064"><B>init</B></FONT><FONT COLOR="#000000"> SpecializedEngineInterface_Tool.new</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we get then the &quot;IEngine&quot; interface</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> ifc : uml::Interface</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		ifc ?= root_package.packagedElement.select{ e | e.name == </FONT><FONT COLOR="#3f5fbe">&quot;IEngine&quot;</FONT><FONT COLOR="#000000"> }.one</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">		</FONT><FONT COLOR="#41825a">// we select and process the classes with a WattsPower attribute</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		root_package.packagedElement.select{ e |</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">			</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> c : uml::Class</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">			c ?= e</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">			</FONT><FONT COLOR="#000064"><B>if</B></FONT><FONT COLOR="#000000"> c != </FONT><FONT COLOR="#7f0055"><I><B>void</B></I></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>then</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">				</FONT><FONT COLOR="#000000"><B>not</B></FONT><FONT COLOR="#000000"> c.ownedAttribute.select{a | a.name == </FONT><FONT COLOR="#3f5fbe">&quot;wattsPower&quot;</FONT><FONT COLOR="#000000">}.isEmpty</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">			</FONT><FONT COLOR="#000064"><B>else</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f0055"><I><B>false</B></I></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		}.each{ cl |</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">			</FONT><FONT COLOR="#000064"><B>var</B></FONT><FONT COLOR="#000000"> c : uml::Class</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">			c ?= cl</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">			</FONT><FONT COLOR="#000064"><B>if</B></FONT><FONT COLOR="#000000"> c != </FONT><FONT COLOR="#7f0055"><I><B>void</B></I></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>then</B></FONT><FONT COLOR="#000000"> ifTool.addInterfaceRealization(ifc, c) </FONT><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">		}</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">}</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">////////////// class for overwrite interface method for name</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000064"><B>class</B></FONT><FONT COLOR="#000000"> SpecializedEngineInterface_Tool </FONT><FONT COLOR="#000064"><B>inherits</B></FONT><FONT COLOR="#000000"> uml::transformations::Interface_Tool</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">{</SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbe">/** overwrite the original method */</FONT></SPAN></FONT></FONT>
<FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000000">	</FONT><FONT COLOR="#000064"><B>method</B></FONT><FONT COLOR="#000000"> nameForInterface(name : kermeta::standard::String) : kermeta::standard::String </FONT><FONT COLOR="#000064"><B>is</B></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#000064"><B>do</B></FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx">	</FONT><FONT COLOR="#7f0055"><I><B>result</B></I></FONT><FONT COLOR="#000000"> := </FONT><FONT COLOR="#3f5fbe">&quot;IEngine&quot;</FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000">    </FONT><FONT FACE="Courier New"><FONT SIZE=2><SPAN LANG="zxx"><FONT COLOR="#000064"><B>end</B></FONT></SPAN></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Sans"><FONT SIZE=2><SPAN LANG="zxx">}</SPAN></FONT></FONT></FONT></PRE><P LANG="en-US" ALIGN=JUSTIFY>
<FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The cloned and
transformed model has been saved under <FONT COLOR="#000000"><FONT FACE="Century Schoolbook L"><FONT SIZE=2><I>improved_vehicules.uml2</I></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2><I>
and can be used</I></FONT></FONT></FONT><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>
as it is or being draft by a graphical tool like TopCased.</FONT></FONT></FONT></FONT></P>
<H2 LANG="en-US" ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Bitstream Vera Sans"><FONT SIZE=4>The
resulting model</FONT></FONT></FONT></H2>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
resulting model of our transformer program looks like above.</FONT></FONT></P>
<P LANG="en-US" ALIGN=JUSTIFY><IMG SRC="../img/Vehicules_improved_model.jpg" NAME="graphics3" ALIGN=LEFT WIDTH=540 HEIGHT=308 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2><B>It
comply with our goals</B>:</FONT></FONT></P>
<UL>
	<LI><P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
	result model includes all the UML elements which were in the
	original model, with all their characteristics.</FONT></FONT></P>
	<LI><P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
	GasEngine class has now an interface and a accessor to its
	attribute.</FONT></FONT></P>
	<LI><P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
	interface operations are abstract when the GasEngine operations are
	concrete implementations (may be with an empty body for some of
	them).</FONT></FONT></P>
	<LI><P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
	ElectricEngine inherits from this interface.</FONT></FONT></P>
	<LI><P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>The
	Car now is now composed of a GasEngine (the corresponding
	association exists in the model even it has not be represented by
	TopCased).</FONT></FONT></P>
</UL>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>Any
UML2 model can be transformed like this.</FONT></FONT></P>
<P LANG="en-US" ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Serif"><FONT SIZE=2>You
can visit it and apply conditional transformations on the fly to each
kind of UML2 element. Look at the Valooder chapter in the
Umlaut-Architecture-Guide to have a idea of how to do.</FONT></FONT></P>
</BODY>
</HTML>
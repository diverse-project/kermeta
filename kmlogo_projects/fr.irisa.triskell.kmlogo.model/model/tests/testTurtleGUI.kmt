/* $Id: testTurtleGUI.kmt,v 1.1 2007-05-31 16:10:49 dvojtise Exp $
 * Creation date: May 31, 2007
 * License:
 * Copyright:
 * Authors:
 */
@mainClass "testTurtleGUI::testTurtleGUI"
@mainOperation "main"


package testTurtleGUI;


require kermeta
require "../TurtleControler.kmt"
using kmLogo::controler
using kmLogo::VM
using kermeta::persistence
using kermeta::standard

class testTurtleGUI
{
	operation main() : Void is do 
		var turtle : Turtle init loadTurtle("Turtle.xmi")
		var controler : TurtleControler init TurtleControler.new.initialize(turtle)
		controler.modelChanged
		stdio.read("press Enter")
		var s : Segment init Segment.new
		var p1 : Point init Point.new
		var p2 : Point init Point.new
		p1.x := 200
		p1.y := 0
		p2.x := 200
		p2.y := 200
		s.origin := p1
		s.destination := p2
		turtle.drawings.add(s)
		controler.modelChanged
		stdio.writeln("end")
		
	end
	operation loadTurtle(uri : String) : Turtle is do
		var res : EMFRepository init EMFRepository.new
        var resource : Resource init res.createResource(uri, "http://kmLogo.ecore/VM")
        resource.load()
        result ?= resource.instances.one  
	end
}
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;3.&nbsp;Define the metamodel</title><link rel="stylesheet" href="css/docbook.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"><meta name="keywords" content="Kermeta, metamodeling, language, kmLogo"><link rel="home" href="index.html" title="Logo Tutorial : Building kmLogo DSL using Kermeta"><link rel="up" href="index.html" title="Logo Tutorial : Building kmLogo DSL using Kermeta"><link rel="prev" href="ch02s02.html" title="2.2.&nbsp;Install logo projects"><link rel="next" href="ch03s02.html" title="3.2.&nbsp;Metamodel Ecore with Kermeta"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;3.&nbsp;Define the metamodel</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s02.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch03s02.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a name="chapter_define_metamodel.link"></a>Chapter&nbsp;3.&nbsp;Define the metamodel<span></span><a name="chapter_MM"></a></h2></div></div></div><p>The first step of this tutorial is to define the abstract syntax. For the logo language,
      the concepts are the instructions to be executed : pen up, pen down, go forward, rotate left
      ... </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="gfx/admonitions/tip.gif"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p> If you want to learn more about how to create an ecore metamodel with eclipse, please
        refer to the available <a class="ulink" href="http://www.kermeta.org/documents/tutorials/tut-create_a_mm/" target="_top">tutorial</a>.</p></td></tr></table></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="section_from_ecore_to_generated_code.link"></a>3.1.&nbsp;From Ecore to genenerated
        code</h2></div></div></div><p>In order to define the metamodel, process as follow : </p><div class="procedure"><ol type="1"><li><p>Inside the project <span class="bold"><strong>
              org.kermeta.kmlogo.logoasm.tutorial</strong></span>, open ther folder <span class="bold"><strong>parts</strong></span> : Here you can see the folders corresponding to the sections of this
            tutorial.</p></li><li><p>Open the folder <span class="bold"><strong>1.metamodel</strong></span> and open the file
              <span class="bold"><strong>ASMLogo.ecore</strong></span> which is the metamodel of your language
            (here logo) and look at its content. In this ecore file you'll notice the various
            instructions supported by the DSL we are building. Some are primitives, for example :
            Back, Forward, Left, PenUp, ... Some are expressions, for example : Plus, Minus, ... And
            some are control structures, for example : If, while, Repeat, ...</p></li><li><p>Let's now set up the property of our metamodel: </p><div class="procedure"><ol type="1"><li><p>Inside the file <span class="bold"><strong>ASMLogo.ecore</strong></span>;</p></li><li><p>Select <span class="bold"><strong>kmLogo</strong></span> package, right-click on it and
                choose <span class="bold"><strong>show properties view</strong></span>;</p></li><li><p>Set the <span class="bold"><strong>ns URI</strong></span> to
                "http://www.kermeta.org/kmLogo" and save it;</p></li></ol></div></li><li><p>Then, create an <span class="bold"><strong>EMF Generator Model</strong></span> (File &gt; New..)
            and name it <span class="bold"><strong>ASMLogo.genmodel</strong></span>, hit next and chosse
              <span class="bold"><strong>Ecore model</strong></span> as model importers, hit next and import
            the previous metamodel (<span class="bold"><strong>Browse workspace</strong></span> &gt;
            org.kermeta.kmlogo.logoasm.tutorial/1.metamodel), <span class="bold"><strong>load</strong></span>
            it, hit next and finish.</p><div class="procedure"><ol type="1"><li><p>Open the file <span class="bold"><strong>ASMLogo.genmodel</strong></span>;</p></li><li><p>Unfold the root element <span class="bold"><strong>ASMLogo</strong></span> and select the
                  <span class="bold"><strong>kmLogo</strong></span> package;</p></li><li><p>Right-click on it and choose<span class="bold"><strong> show properties
                  View</strong></span> (if not already open),  set the <span class="bold"><strong>base
                  package</strong></span> (unfold All in property view) property to : <span class="bold"><strong>org.kermeta.kmlogo.logoasm.model</strong></span>;</p></li><li><p>For the <span class="bold"><strong>ASM package</strong></span> (unfold kmLogo package) set
                its <span class="bold"><strong>File Extension</strong></span> (unfold Model in the property
                view) property to "logoasm";</p></li><li><p>Right-click on the root element <span class="bold"><strong>ASMLogo</strong></span> and
                  choose<span class="bold"><strong> show properties View</strong></span> (if not already
                open); </p></li><li><p>In the <span class="bold"><strong>property view</strong></span>, unfold <span class="bold"><strong>Model</strong></span>: </p><div class="itemizedlist"><ul type="disc"><li><p>Set "Model Directory" to <span class="bold"><strong>/org.kermeta.kmlogo.logoasm.model/src</strong></span>
                    </p></li><li><p>Set "Model Plug-in ID" to <span class="bold"><strong>org.kermeta.kmlogo.logoasm.model</strong></span></p></li></ul></div></li><li><p>In the <span class="bold"><strong>property view</strong></span>, unfold <span class="bold"><strong>Edit</strong></span>: </p><div class="itemizedlist"><ul type="disc"><li><p>Set "Edit Directory" to <span class="bold"><strong>/org.kermeta.kmlogo.logoasm.edit/src</strong></span>
                    </p></li><li><p>Set "Edit Plug-in Class" to <span class="bold"><strong>org.kermeta.kmlogo.logoasm.kmLogo.provider.ASMLogoEditPlugin</strong></span></p></li><li><p>Set "Edit plug-in ID" to <span class="bold"><strong>org.kermeta.kmlogo.logoasm.edit</strong></span></p></li></ul></div></li><li><p>In the <span class="bold"><strong>property view</strong></span>, unfold <span class="bold"><strong>Editor</strong></span>: </p><div class="itemizedlist"><ul type="disc"><li><p>Set "Editor Directory" to <span class="bold"><strong>/org.kermeta.kmlogo.logoasm.editor/src</strong></span>
                    </p></li><li><p>Set "Editor Plug-in Class" to <span class="bold"><strong>org.kermeta.kmlogo.logoasm.kmLogo.presentation.ASMLogoEditorPlugin</strong></span></p></li><li><p>Set "Editor plug-in ID" to <span class="bold"><strong>org.kermeta.kmlogo.logoasm.editor</strong></span></p></li></ul></div></li><li><p>Save and go back to the genmodel editor, right-click on the <span class="bold"><strong>kmLogo package</strong></span> (unfold ASMLogo) and choose<span class="bold"><strong> show properties View</strong></span> (if not already open); </p></li></ol></div></li><li><p>Once we've set up these settings, save your generator model. Let's directly generate
            the associated code for our metamodel. (A needed step for the rest of the
            tutorial):</p><p>Inside the <span class="bold"><strong>ASMLogo.genmodel</strong></span>, right-click on kmLogo
            package and choose <span class="bold"><strong>Generate Model Code</strong></span>. This will add a
            new project <span class="bold"><strong>org.kermeta.kmlogo.logoasm.model</strong></span> to your
            structure.</p><p>Repeat the step above and choose<span class="bold"><strong> Generate Edit
            code</strong></span>. This will add a new project <span class="bold"><strong>org.kermeta.kmlogo.logoasm.model.edit</strong></span> to your structure.</p><p>Repeat again and choose<span class="bold"><strong> Generate Editor Code</strong></span>. This
            will add the project <span class="bold"><strong>org.kermeta.kmlogo.logoasm.model.editor</strong></span>.</p><p>You may <span class="bold"><strong>copy</strong></span> the files ASMLogo.ecore and
            ASMLogo.genmodel inside a folder <span class="bold"><strong>org.kermeta.kmlogo.logoasm.model/model</strong></span> in order to store them.</p><p>You should now have a project structure as illustrated below : </p><div class="figure"><a name="d0e416"></a><div class="figure-contents"><div class="mediaobject"><img src="Kermeta-Tutorial-Logo_figures/KermetaProjectStructure.png" alt="Project structure after generating the model, edit and editor code"></div></div><p class="title"><b>Figure&nbsp;3.1.&nbsp;Project structure after generating the model, edit and editor code</b></p></div><p><br class="figure-break"></p></li><li><p>Go back to the file <span class="bold"><strong>org.kermeta.kmlogo.logoasm.model/model/ASMLogo.ecore</strong></span>:</p><p>Right-click on it and initialise the ecore diagram file (more information about
            create an .ecorediag file from scratch is available here). </p><p>Name it <span class="bold"><strong>ASMLogo.ecorediag</strong></span>, hit next and choose
              <span class="bold"><strong>ASM</strong></span> package as a root element and finish to see the
            graphical representation of your metamodel (if you choose kmLogo as a root element then
            you will have to double-click on<span class="bold"><strong> Package ASM</strong></span> to open it
            and then <span class="bold"><strong>Create</strong></span> button from the window wizard). </p><p>You should obtain an overview of all the concepts in your metamodel (see the figure
            below).</p></li></ol></div><div class="figure"><a name="d0e446"></a><div class="figure-contents"><div class="mediaobject"><img src="Kermeta-Tutorial-Logo_figures/KermetaLogoMM.png" alt="The logo metamodel"></div></div><p class="title"><b>Figure&nbsp;3.2.&nbsp;The logo metamodel</b></p></div><br class="figure-break"><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="gfx/admonitions/important.gif"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p><span class="bold"><strong>Before going further</strong></span> in this tutorial, do not forget
          (if not already done) :</p><div class="itemizedlist"><ul type="disc"><li><p><a class="ulink" href="" target="_top">To set up the nsURI</a> of the <span class="bold"><strong>model/ASMLogo.ecore</strong></span> file;</p></li><li><p>To <a class="link" href="ch05.html#section_package_registry.title.link">register this ecore
                  model</a> (In deployed mode (ie. in a runtime workbench), the ecore is
                automatically registered by the plugin, in development mode, you need to manually
                register it).</p></li></ul></div></td></tr></table></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s02.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch03s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2.2.&nbsp;Install logo projects&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;3.2.&nbsp;Metamodel Ecore with Kermeta</td></tr></table></div></body></html>
// $Id: 028_testUsedRequire_PostFailed.main.kmt,v 1.2 2008-07-31 16:11:43 dvojtise Exp $
@mainClass "usedRequire::PostFailed"
@mainOperation "main"


package usedRequire;


require kermeta
require "toBeRequired.kmt"
using kermeta::standard
using kermeta::exceptions
using kermeta::kunit

class PostFailed inherits TestCase
{	

	operation main() : Void is do
    	var tr : TestRunner init TestRunner.new
		tr.run(PostFailed)
		tr.printTestResult 
    end	

    operation test0() : Void is do 
        var m : MainToBeRequired init MainToBeRequired.new
        
        m.strRequired := "trucRequiredPre"
        m.b := true
        
        do
	        m.truc("not trucRequiredPost")
        	assert(false)
        rescue (err : ConstraintViolatedPre)
       		stdio.writeln(err.toString)
        	stdio.writeln(err.message)
        	assert(false)
       	rescue (err : ConstraintViolatedPost) 
       		stdio.writeln(err.toString)
       		stdio.writeln(err.message)
  			assert(true)
       	end
       	    	
        do	 
        	m.checkInvariants
        	assert(true)
        	rescue (err : ConstraintViolatedInv) 
        		stdio.writeln(err.toString)
        		stdio.writeln(err.message)
       			assert(false)
       end
    end
}
/* $Id: GenericTypeDefinitionHelper.kmt,v 1.2 2008-04-21 15:26:24 cfaucher Exp $
 * Creation date: April 07, 2008
 * License: EPL
 * Copyright: IRISA / INRIA / Universite Rennes 1
 * Authors: Cyril Faucher <cfaucher@irisa.fr>
 */


package km2ecore::helper::kermeta;


require kermeta
require "platform:/resource/org.kermeta.compiler.kmt/src/kermeta/common/KeywordList.kmt"
require "platform:/resource/org.kermeta.compiler.kmt/src/kermeta/KM2EcoreContext.kmt"
require "platform:/resource/org.kermeta.compiler.kmt/src/kermeta/pass2/CreateBehavior.kmt"

using kermeta::language::structure
using kermeta::language
using km2ecore

class GenericTypeDefinitionHelper {
	
	/**
	 * Tests whether the Type t corresponds to a Kermeta numerical type, which can be encoded
	 * either as the Integer/Real PrimitiveType or the Integer/Real class.
	 * @param t : Type
	 * @return true or false
	 */
	operation isNumericalTypeDef(t : Type, context : KM2EcoreContext) : Boolean is do
		
		if not t.isVoid() then
		
			var tName : String init void
			if t.isInstanceOf(Class) then
				tName := t.asType(ParameterizedType).typeDefinition.name
				if tName.equals("Integer") or tName.equals("Real") then
					result := true
				else
					result := false
				end
			else if t.isInstanceOf(PrimitiveType) then
					tName := t.asType(PrimitiveType).createBehaviorJava(context)
					if tName.equals("Integer") or tName.equals("Real") then
						result := true
					else
						result := false
					end
				else
					result := false
				end
			end
		
		else
			result := false
		end
		
	end
	
	/**
	 * Tests whether the Type t corresponds to the Kermeta Boolean type, which can be encoded
	 * either as the Boolean PrimitiveType or the Boolean class.
	 * @param t : Type
	 * @return true or false
	 */
	operation isBooleanTypeDef(t : Type, context : KM2EcoreContext) : Boolean is do
		
		if not t.isVoid() then
		
			if t.isInstanceOf(Class) then
				result := t.asType(Class).typeDefinition.name.equals("Boolean")
			else if t.isInstanceOf(PrimitiveType) then
					result := t.asType(PrimitiveType).createBehaviorJava(context).equals("Boolean")
				else
					result := false
				end
			end
			
		else
			result := false
		end
		
	end
}

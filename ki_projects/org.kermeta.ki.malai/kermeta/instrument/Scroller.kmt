/*
 * Creation : April 6, 2010
 * Licence  : EPL 
 * Copyright: INRIA Rennes, Triskell Team
 * Authors  : Arnaud Blouin
 */
package kermeta::ki::malai::instrument;

require kermeta
require "platform:/resource/org.kermeta.ki.malai/kermeta/instrument/Instrument.kmt"
require "platform:/resource/org.kermeta.ki.malai/kermeta/action/Scroll.kmt"
require "platform:/resource/org.kermeta.ki.malai/kermeta/interaction/library/KeysScroll.kmt"


using kermeta::ki::malai::instrument
using kermeta::ki::malai::widget
using kermeta::ki::malai::action
using kermeta::ki::malai::interaction
using kermeta::language::structure


class Scroller inherits Instrument {
	reference panel : Panel
	
	method initialiseLinks() : Void is do
		addLink(Scrolling2Scroll.new, false)
	end
}



class Scrolling2Scroll inherits Link {
	method createInteraction() : Interaction is do
		result := KeysScroll.new
	end
	
	
	method getActionClass() : Class is do
		result := Scroll
	end
	
	
	method isConditionRespected() : Boolean is do
		result := interaction.asType(KeysScroll).keys.empty()
	end
	
	
	method createAction() : Void is do
		var scroll    : Scroll     init Scroll.new
		
		scroll.panel     := instrument.asType(Scroller).panel 
		scroll.increment := -interaction.asType(KeysScroll).increment*20
		action 		     := scroll
		action.initialise(instrument.actionRegistry)
	end
	
	
	method updateAction() : Void is do end
}

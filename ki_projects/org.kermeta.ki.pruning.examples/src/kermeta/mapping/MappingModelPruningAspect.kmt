/* $Id:$ 
 * Creation : November 17, 2010
 * Licence  : EPL 
 * Copyright:
 * Authors  : 
 *            ablouin
 */
package ex::mappingModel;

require kermeta
require "MappingModel.kmt"
require "ClassModelPruningAspect.kmt"

using kermeta::standard
using ex::classModel


aspect class Mapping {
	attribute visited : Boolean

	operation initialiseOpposite() : Void is do
		targets.each{theClazz | theClazz.targetsOpposite.add(self) }
		srcs.each{theClazz | theClazz.srcsOpposite.add(self) }
	end
	
	
	operation visit(theMappingModelPruning : MappingModelPruning) : Void is do
		self.visited := true
		theMappingModelPruning.onMappingAdded(self)
		theMappingModelPruning.addedMappings.add(self)
	end
	
	
	operation addClazzs(theMappingModelPruning : MappingModelPruning, theClazzs : Bag<Clazz>) : Void is do
		if(not visited) then
			srcs.each{theClazz | if(not theClazz.visited) then theClazzs.add(theClazz) end } 
			targets.each{theClazz | if(not theClazz.visited) then theClazzs.add(theClazz) end } 
		end 
	end
}

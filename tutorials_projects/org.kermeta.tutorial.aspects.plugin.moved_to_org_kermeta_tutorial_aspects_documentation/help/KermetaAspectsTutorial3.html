<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>What can Aspect Oriented Programming change?</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.2  (Linux)">
	<META NAME="CREATED" CONTENT="20071211;9300000">
	<META NAME="CHANGEDBY" CONTENT="Vincent Mahe">
	<META NAME="CHANGED" CONTENT="20071211;9300000">
</HEAD>
<BODY LANG="fr-FR" BGCOLOR="#ffffff" DIR="LTR">
<H1><FONT FACE="Nimbus Sans L"><FONT SIZE=5>What can Aspect Oriented
Programming change?</FONT></FONT></H1>
<P>It is possible to write Kermeta code using a simplified Aspect
Oriented approach.</P>
<P>Technically, you can declare classes as &quot;aspects&quot; that
will contribute features (attributes, references, properties,
operations, constraints) to an existing class. In such situation, the
definition of two classes that have the same qualified name will be
merged into a single class in the interpreter memory.</P>
<P>This is a great help when you want to separate the concerns into
several files. For example, you may have one file that strictly
conforms to the structural part of your metamodel, one file
containing the constraints for a given purpose and another file
containing the operation and special extension to the metamodel for
an interpreter.</P>
<P>Obviously, the merge will be successful only if there is no
conflict between all the declared features.</P>
<H2>Textual syntax for merging</H2>
<DL>
	<DD>
	<TABLE WIDTH=547 BORDER=0 CELLPADDING=2 CELLSPACING=0>
		<COL WIDTH=26>
		<COL WIDTH=513>
		<TR>
			<TD ROWSPAN=2 WIDTH=26 VALIGN=TOP BGCOLOR="#ffffcc">
				<P ALIGN=CENTER><BR>
			</TD>
			<TH WIDTH=513 BGCOLOR="#ffffcc">
				<P ALIGN=LEFT>Important</TH>
		</TR>
		<TR>
			<TD WIDTH=513 VALIGN=TOP BGCOLOR="#ffffcc">
				<P ALIGN=LEFT>Since this feature is really successful and very
				well accepted, the surface syntax will change in the future
				release v1.0.0 in order to use a dedicated keyword instead of a
				simple annotation. The syntax presented here is valid only for
				prior versions. 
			</TD>
		</TR>
	</TABLE>
</DL>
<P LANG="en-US">The merge is driven by the qualified name of the
element to merge. Two classes will be merged if they have exactly the
same qualified name (packages names + class name)</P>
<P LANG="en-US">In order to keep the compatibility with previous
behaviour, the merge is allowed only if you add some tags:</P>
<DL>
	<DT LANG="en-US"><B>@aspect &quot;true&quot;</B></DT><DD><P LANG="en-US">
	is placed on a class, it indicates that this class is an aspect of
	another one. This allows to complement a class with the features of
	the aspect class.</P></DD><DT LANG="en-US">
	<B>@overloadable &quot;true&quot;</B></DT><DD><P LANG="en-US">
	is placed on an operation, it indicates that the body of the
	operation can be overloaded by another definition of the same
	operation in an aspect class. This is useful in some situation were
	the code expect to be overloaded.</P></DD><DD>
	<TABLE WIDTH=547 BORDER=0 CELLPADDING=2 CELLSPACING=0>
		<COL WIDTH=26>
		<COL WIDTH=513>
		<TR>
			<TD ROWSPAN=2 WIDTH=26 VALIGN=TOP BGCOLOR="#ffffcc">
				<P ALIGN=CENTER><BR>
			</TD>
			<TH WIDTH=513 BGCOLOR="#ffffcc">
				<P ALIGN=LEFT>Note</TH>
		</TR>
		<TR>
			<TD WIDTH=513 VALIGN=TOP BGCOLOR="#ffffcc">
				<P ALIGN=LEFT>When using overloadable tag, for a given set of
				definition, the operation that is not tagged overlodable will
				overload all other definitions. If all the declarations declare
				to be overloadable, then the declaration order is important. The
				last declared will be used by the interpreter. 
			</TD>
		</TR>
	</TABLE>
</DL>
<H2>Example: adding properties and methods to UML2 elements</H2>
<DL>
	<DT>For our UML2 -&gt; FSM model transformation, we will need a way
	to do something on UML2 &laquo;&nbsp;Package&nbsp;&raquo; element.</DT><DT>
	First, we need to conform with the UML2 models tree, which have
	&laquo;&nbsp;uml&nbsp;&raquo; as top package:</DT><DT>
	Create a new Kermeta file with &laquo;&nbsp;uml&nbsp;&raquo; as root
	package. Your file only needs few lines for the moment:</DT><DD><P>
	<FONT COLOR="#000064"><FONT FACE="Sans"><FONT SIZE=2><B>package</B></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Sans"><FONT SIZE=2>
	</FONT></FONT></FONT><FONT COLOR="#000064"><FONT FACE="Sans"><FONT SIZE=2>uml</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Sans"><FONT SIZE=2>;<BR></FONT></FONT></FONT><FONT COLOR="#960000"><FONT FACE="Sans"><FONT SIZE=2><B>require</B></FONT></FONT></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064"><FONT FACE="Sans"><FONT SIZE=2>kermeta<BR></FONT></FONT></FONT><FONT COLOR="#960000"><FONT FACE="Sans"><FONT SIZE=2><B>require</B></FONT></FONT></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#3f5fbe"><FONT FACE="Sans"><FONT SIZE=2>&quot;platform:/plugin/org.eclipse.uml2.uml/model/UML.ecore&quot;</FONT></FONT></FONT></P></DD><DT>
	You can then add the Package class in order to improve it:</DT><DD>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000064"><B>class</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064">Package</FONT><FONT COLOR="#000000"> {</FONT></FONT></FONT></DD><DD><P>
	<FONT COLOR="#000000"><FONT FACE="Sans"><FONT SIZE=2>}</FONT></FONT></FONT></P></DD><DT>
	But now, the Kermeta environment throws an error, because you define
	a Package class which exists inside the &laquo;&nbsp;uml&nbsp;&raquo;
	package of the UML2 metamodel.</DT><DT>
	You must specify that your Package class will be woven with the
	existing one:</DT><DD>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000000">@</FONT><FONT COLOR="#000064">aspect</FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#3f5fbe">&quot;true&quot;</FONT></FONT></FONT></DD><DD><P>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000064"><B>class</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064">Package</FONT><FONT COLOR="#000000">
	{<BR></FONT><FONT COLOR="#000000"><FONT FACE="Sans"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></FONT></P></DD></DL>
<P>
From now, all stuff you will add to this class will be added to the
UML2 Package class.</P>
<P>As an example, you may add a aNewOperation() method:</P>
<DL>
	<DD><FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000000">@</FONT><FONT COLOR="#000064">aspect</FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#3f5fbe">&quot;true&quot;</FONT></FONT></FONT></DD><DD>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000064"><B>class</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064">Package</FONT><FONT COLOR="#000000"> {</FONT></FONT></FONT></DD><DD>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000064"><B>	operation</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064">aNewOperation</FONT><FONT COLOR="#000000">()
	</FONT><FONT COLOR="#000064"><B>is</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064"><B>do</B></FONT></FONT></FONT></DD><DD>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#41825a"><B>	// </B></FONT><FONT COLOR="#41825a">some
	stuf to be done when this method is called during Kermeta exec</FONT></FONT></FONT></DD><DD><P>
	<FONT COLOR="#000064"><FONT FACE="Sans"><FONT SIZE=2><B>	end<BR></B><FONT COLOR="#000000"><FONT FACE="Sans"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></FONT></FONT></P></DD></DL>
<P>
After that, you can see this operation inserted into the UML2 Package
element in the Kermeta outline:</P>
<P><BR><BR>
</P>
<P ALIGN=LEFT>As you can see, the outline icon for the UML2 Package
has changed and informs you this element is partly redefined by
current Kermeta file.</P>
<P ALIGN=CENTER><IMG SRC="../img/KermetaAspectsTutorial1.png" NAME="graphics1" ALIGN=LEFT WIDTH=400 HEIGHT=309 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P ALIGN=LEFT>Using the same way, you can add new properties
on-the-fly to a write-only metamodel, in order to handle specific
behavior or processes on its models:</P>
<DL>
	<DD><FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000000">@</FONT><FONT COLOR="#000064">aspect</FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#3f5fbe">&quot;true&quot;</FONT></FONT></FONT></DD><DD>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000064"><B>class</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064">Package</FONT><FONT COLOR="#000000"> {</FONT></FONT></FONT></DD><DD>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000064"><B>	reference</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000064">myProperty : uml::Element</FONT></FONT></FONT></DD><DD><P>
	<FONT FACE="Sans"><FONT SIZE=2><FONT COLOR="#000064"><B>	attribute</B></FONT><FONT COLOR="#000064">
	anotherNonUmlProperty : kermeta::standard::String<BR></FONT><FONT COLOR="#000000"><FONT FACE="Sans"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></FONT></P></DD></DL>
<P>
All those &laquo;&nbsp;aspect&nbsp;&raquo; features will help you
challenge the tutorial main work, which is the realization of the
UML2 -&gt; FSM transformation</P>
</BODY>
</HTML>
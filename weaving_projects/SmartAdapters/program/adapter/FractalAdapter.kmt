/* $Id: FractalAdapter.kmt,v 1.4 2008-06-09 07:03:54 bmorin Exp $
 * Creation date: March 19, 2008
 * License:
 * Copyright: IRISA / INRIA Rennes Bretagne Atlantique
 * Authors: Brice Morin bmorin@irisa.fr
 */

package org::kermeta::runtime::adapter;

require kermeta
require "platform:/resource/SmartAdapters/program/adapter/PlatformAdapter.kmt"

using kermeta::standard
using kermeta::persistence

/**
 * This class is a bridge between Kermeta and Fractal
 * Note: it does not implement the run operation
 */
aspect class PlatformAdapter
{
	operation ~init() : Void is
	do
		//extern org::kermeta::smartadapters::runtime::fractal::SmartAdaptersToFractal.~init(self)
		extern org::diva::causalLink::smartadapters::fractal::SmartAdaptersToFractal.~init(self)
	end
		
	operation generateAndSaveModel(modelUri : String) : Void is
	do
		//extern org::kermeta::smartadapters::runtime::fractal::SmartAdaptersToFractal.generateAndSaveEMFModel(self, modelUri)
		extern org::diva::causalLink::smartadapters::fractal::SmartAdaptersToFractal.generateAndSaveEMFModel(self, modelUri)
	end
	
	operation saveModel(modelUri : String) : Void is
	do
		//extern org::kermeta::smartadapters::runtime::fractal::SmartAdaptersToFractal.saveEMFModel(self, modelUri)
		extern org::diva::causalLink::smartadapters::fractal::SmartAdaptersToFractal.saveEMFModel(self, modelUri)
	end	
	
	operation loadUpdateModel(modelUri : String) : Void is 
	do
		var repository : EMFRepository init EMFRepository.new
		var resource : Resource init repository.createResource(modelUri, "platform:/plugin/org.kermeta.art.model/model/metamodel@runtime.ecore")
		resource.load()
				
		//repository.createResource(baseModelUri, domainMMUri)
		//extern org::kermeta::smartadapters::runtime::fractal::SmartAdaptersToFractal.loadUpdateModel(self, modelUri)
		extern org::diva::causalLink::smartadapters::fractal::SmartAdaptersToFractal.loadUpdateModel(self, resource.instances.one)
	end
}		
